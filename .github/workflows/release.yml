name: Release

on:
  push:
branches: [main]

jobs:
  release:
if: github.ref == 'refs/heads/main'
runs-on: ubuntu-latest
steps:
  - name: Checkout code
uses: actions/checkout@v4
with:
  fetch-depth: 0

  - name: Setup Node.js
uses: actions/setup-node@v4
with:
  node-version: '18'
  cache: 'yarn'

  - name: Install dependencies
run: yarn install --frozen-lockfile

  - name: Build packages
run: yarn build

  - name: Run tests
run: yarn test

  # Add deployment steps here based on your hosting platform
  # Example for Vercel:
  # - name: Deploy to Vercel
  #   uses: amondnet/vercel-action@v20
  #   with:
  # vercel-token: ${{ secrets.VERCEL_TOKEN }}
  # vercel-org-id: ${{ secrets.ORG_ID }}
  # vercel-project-id: ${{ secrets.PROJECT_ID }}
  # vercel-args: '--prod'